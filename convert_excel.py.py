import pandas as pd

# ==========================================
# ส่วนที่ต้องแก้ไข (Config)
# ==========================================
source_file = 'จดทะเบียน 1-30 ม.ค. 69-2.xlsx'       # ชื่อไฟล์ Excel ต้นฉบับ (ต้องวางไว้ที่เดียวกับไฟล์โค้ด หรือใส่ path เต็ม)
output_file = 'จดทะเบียน 1-30 ม.ค. 69-2.csv'         # ชื่อไฟล์ CSV ปลายทางที่ต้องการ
selected_columns = [               # รายชื่อคอลัมน์ที่ต้องการ (ต้องเขียนให้ตรงกับหัวตารางเป๊ะๆ)
    'หมายเลขตัวถัง', 'จังหวัด', 'ทะเบียน','วันที่จดทะเบียน','ผู้ถือกรรมสิทธิ์','ผู้ถือครอง','แผ่นป้าย','ป้ายวงกลม','คู่มือ','สาขา'
]
# ==========================================

try:
    print(f"กำลังอ่านไฟล์ {source_file} ...")
    # อ่านไฟล์ Excel
    df = pd.read_excel(source_file)

    # เลือกเฉพาะคอลัมน์ที่ระบุไว้
    df_selected = df[selected_columns]

    # บันทึกเป็น CSV
    # index=False : ไม่เอาเลขบรรทัด (0,1,2..) ติดไป
    # encoding='utf-8-sig' : สูตรสำคัญที่ทำให้เปิด CSV ใน Excel แล้วภาษาไทยไม่เพี้ยน
    df_selected.to_csv(output_file, index=False, encoding='utf-8-sig')

    print(f"✅ สำเร็จ! บันทึกไฟล์เรียบร้อยแล้วที่: {output_file}")

except FileNotFoundError:
    print(f"❌ ไม่พบไฟล์: {source_file} (ตรวจสอบว่าชื่อไฟล์ถูกไหม หรือวางไฟล์ถูกโฟลเดอร์ไหม)")
except KeyError as e:
    print(f"❌ ชื่อคอลัมน์ผิด: {e} (ลองเช็คว่าพิมพ์ชื่อคอลัมน์ตรงกับใน Excel เป๊ะๆ หรือยังรวมถึงเว้นวรรคด้วย)")
except Exception as e:
    print(f"❌ เกิดข้อผิดพลาดอื่นๆ: {e}")